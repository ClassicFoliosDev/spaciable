<% homeowner_plots = plots.where(letter_type: :homeowner)%>
<% homeowner_plots.each do |plot| %>
  <% if plot.letable? && current_resident&.plot_residency_homeowner?(plot)%>
    <% let_status = plot.let ? "let-plot" : "unlet-plot" %>
    <div class="<%= let_status %>">
      <div class="letable-plot branded-content branded-border">
        <div class="plot-address branded-text">
          <h3>Plot <%= plot.number %></h3>
          <p>
            <%= render "components/homeowner/formatted_address", address: plot %>
          </p>
        </div>
        <div class="letable-options">
          <% if plot.let %>
            <% if Letting.current_resident_letting(current_resident, plot) %>
              <div class="let-out"><span><%= t(".let_out") %></span></div>
              <%= link_to t(".dashboard"), "https://en.wikipedia.org/wiki/Cats_(musical)", class: "btn letting-btn" %>
            <% else %>
              <div class="let-out"><span><%= t(".let_out_other", other: Letting.resident_letter(plot)) %></span></div>
            <% end %>
          <% else %>
            <div class="un-let"><span><%= t(".un_let") %></span></div>
            <%= button_tag t(".let_my_plot"), class: "btn letting-btn let-plot",
              data: { cancel: t("edit.cancel"),
                cta: t(".submit"),
                title: t(".plot_details"),
                plot: plot.id,
                address1: [plot&.postal_number, plot&.building_name].compact.join(" "),
                address2: plot&.road_name || "",
                town: plot&.city || "",
                postcode: plot&.postcode || ""
              } %>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
<% end %>
