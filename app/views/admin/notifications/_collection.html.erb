<% if can? :crud, Notification %>
  <div class="section-actions">
    <%= link_to [:new, :admin, :notification], class: "btn btn-primary" do %>
        <i class="fa fa-plus"></i>
        <span class="btn-label"><%= t(".add") %></span>
    <% end %>
  </div>
<% end %>

<table class="record-list">
  <thead>
    <tr>
      <th colspan="3"><%= sortable(Notification, :subject, t(".headers.subject")) %></th>
      <th><%= sortable(Notification, :sent_at, t(".headers.sent_at")) %></th>
      <th colspan="2"><%= t(".headers.recipient") %></th>
      <th><%= t(".headers.role") %></th>
      <th colspan="2"><%= t(".headers.sender") %></th>
      <th colspan="1">&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <% collection.each do |notification| %>
        <tr>
          <td colspan="3">
            <span class="notification-title"><%= link_to notification, [:admin, notification], title: notification %></span><br/>
            <%= truncate(strip_tags(notification.message).html_safe, length: 120) %>
          </td>

          <td>
            <% if notification&.sent_at %>
              <%= l(notification.sent_at.to_date, format: :digits) %>
            <% end %>
          </td>
          <td colspan="2">
            <%= truncate(notification.sent_to, length: 120) %>
          </td>
          <td>
            <%= notification.send_to_role || "both" %>
          </td>
          <td colspan="2">
            <%= notification.sent_from %>
          </td>
          <td colspan="1" class="actions">
            <%= view_btn admin_notification_path(notification) %>
          </td>

        </tr>
    <% end %>
  </tbody>
</table>

<div class="paging">
  <%= render 'components/page_size' %>
  <%= paginate collection %>
</div>
