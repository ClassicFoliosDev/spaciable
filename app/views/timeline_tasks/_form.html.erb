<style>
div.scrollmenu {
  background-color: #d0d0e1;
  overflow: auto;
  white-space: nowrap;
}

div.scrollmenu a {
  display: inline-block;
  color: black;
  text-align: center;
  padding: 14px;
  text-decoration: none;
}

div.scrollmenu a:hover {
  background-color: #777;
}

group + group {
  margin-top: 20px;
}

.inline-radio {
  display: flex;
  border-radius: 3px;
  overflow: hidden;
  border: 1px solid #b6b6b6;
}

.btn-group button {
  background-color: red; /* Green background */
  border: 1px grey; /* Green border */
  color: White; /* White text */
  padding: 10px 24px; /* Some padding */
  cursor: pointer; /* Pointer/hand icon */
  float: left; /* Float the buttons side by side */
}

.btn-group button:not(:last-child) {
  border-right: none; /* Prevent double borders */
}

/* Clear floats (clearfix hack) */
.btn-group:after {
  content: "";
  clear: both;
  display: table;
}

/* Add a background color on hover */
.btn-group button:hover {
  background-color: #3e8e41;
}

</style>

<% def action?(option) action_name.to_sym == option; end %>

<div class="section-title">
  Your Journey
  <p style="color:red"><%= timeline_task&.stage&.title %></p>
</div>

<div class="scrollmenu">
  <% timeline.ttasks&.each do |tt| %>
    <% if action?(:new) && @insert_mode == :before && tt.id == @insertion_task.id %>
      <a style="font-weight:bold" >New</a>
    <% end %>
    <a <%= "style=font-weight:bold" if timeline_task.present? && timeline_task == tt %>><%= tt.title %></a>
    <% if action?(:new) && @insert_mode == :after && tt.id == @insertion_task.id %>
      <a style="font-weight:bold">New</a>
    <% end %>
  <% end %>
</div>

<%= simple_form_for ([timeline, timeline_task]) do |f| %>
  <%= f.fields_for :stage do |s| %>
    <group class="inline-radio" >
      <%= s.collection_radio_buttons :option, @stages, :first, :last, checked: @timeline_task.stage.id, disabled: @disabled_stages %>
    </group>
  <% end %>

  <%= f.simple_fields_for timeline_task.task, :task do |t| %>
    <%= t.input :title, label: t(".heading") %>
    <%= t.input :question, label: t(".question") %>
    <%= t.input :answer, label: t(".answer") %>
    <%= t.input :response, label: t(".response"), as: :ckeditor%>
    <%= t.input :positive, label: t(".positive") %>
    <%= t.input :negative, label: t(".negative") %>
    <%= t.label :not_applicable, t(".not_applicable") %>
    <%= t.check_box :not_applicable %>
  <% end %>

  <%= f.fields_for :feature do |ft| %>
    <%= ft.input :title, label: t(".feature.title"), input_html: {value: timeline_task.feature&.title} %>
    <%= ft.input :description, label: t(".feature.description"), input_html: {value: timeline_task.feature&.description} %>
     <%= ft.input :link, label: t(".feature.link"), input_html: {value: timeline_task.feature&.link} %>
  <% end %>

  <%= f.fields_for :action do |ft| %>
    <%= ft.input :title, label: t(".action.title"), input_html: {value: timeline_task.action&.title} %>
    <%= ft.input :description, label: t(".action.description"), input_html: {value: timeline_task.action&.description} %>
    <%= ft.input :link, label: t(".feature.link"), input_html: {value: timeline_task.action&.link} %>

    <p>Circle Shortcuts</p>
    <%= f.fields_for :shortcuts do |s| %>
      <% timeline.shortcuts.each do |ts| %>
        <%= s.label ts.shortcut_type.to_sym, ts.shortcut_type %>
        <%= s.check_box ts.shortcut_type.to_sym, checked: timeline_task&.timeline_task_shortcuts&.find_by(shortcut_type: ts.shortcut_type)&.live %>
      <% end %>
    <% end %>
  <% end %>

  <% if action?(:new) %>
    <%= f.fields_for :donor do |d| %>
      <%= d.hidden_field :task_id, value: @insertion_task&.id %>
      <%= d.hidden_field :mode, value: @insert_mode %>
    <% end %>
  <% end %>

  <div class="form-actions-footer-container">
    <div class="form-actions-footer">
      <% if action?(:new) %>
        <% if insert_task %>
          <%= link_to t(".cancel"), timeline_timeline_task_path(timeline, insert_task), class: "btn" %>
        <% else %>
          <%= link_to t(".cancel"), timeline_empty_path(@timeline), class: "btn" %>
        <% end %>
      <% else %>
        <%= link_to t(".cancel"), timeline_timeline_task_path , class: "btn" %>
      <% end %>
      <%= f.submit t(".submit"), class: "btn-form-submit btn-primary" %>
    </div>
  </div>
<% end %>
