$(document).on('cocoon:after-insert', function(event, item) {

  // Set the CSS style classes on the selects that we've just added
  $('select').selectmenu();
});

$(document).on('click', '.finishes .ui-menu-item', function (event) {

  var optionName = this.innerText;
  var $selectContainer = $(this).closest(".select-container");
  var listName = $selectContainer[0].classList;
  var parentFieldset = $selectContainer.closest("fieldset");

  if (listName.contains("finish-category")) {
    var finishTypeDiv = parentFieldset.find(".finish-type");
    var finishTypeSelect = clearFields(finishTypeDiv);

    var manufacturerDiv = parentFieldset.find(".manufacturer");
    clearFields(manufacturerDiv);

    var url = "/finish_types";
    setFields(finishTypeSelect, url, { option_name: optionName });

  } else if (listName.contains("finish-type")) {
    var manufacturerDiv = parentFieldset.find(".manufacturer");
    var manufacturerSelect = clearFields(manufacturerDiv);

    clearFields(manufacturerDiv);

    var url = "/manufacturers";
    setFields(manufacturerSelect, url, { option_name: optionName });
  }
});
