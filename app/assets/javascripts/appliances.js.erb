$(document).on('click', '.appliance .ui-menu-item', function (event) {

  var optionName = this.innerText;
  var $selectContainer = $(this).closest(".select-container");

    if ($selectContainer.length > 0) {
    var listClasses = $selectContainer[0].classList;
    var $parentFieldset = $selectContainer.closest(".appliance");

    var add_appliance = $(document).find(".add_appliance");

    if (listClasses.contains("appliance_category")) {

      var $manufacturerDiv = $parentFieldset.find(".manufacturer");
      var $manufacturerSelect = clearFields($manufacturerDiv);

      var url = "/appliance_manufacturers";
      setFields($manufacturerSelect, url, { option_name: optionName });
    }
    // Only run through this code if adding an appliance to a room
    // Not when creating a new appliance
    else if (listClasses.contains("manufacturer") && (add_appliance.length > 0)) {
      var $applianceDiv = $parentFieldset.find(".appliances");

      var $applianceSelect = clearFields($applianceDiv);

      var $categoryDiv = $(".appliance_category");
      var $categoryValue = $categoryDiv.find(".ui-selectmenu-text")[0].innerHTML;

      var url = "/appliance_list";
      setFields($applianceSelect, url, { option_name: optionName, category_name: $categoryValue});
    }
  }
});

function no_appliance_matches() {
  var $parentFieldset = $(document).find(".appliances.select-container");

  var noMatches =  document.createElement("span");
  noMatches.innerHTML = "<%= I18n.t(".appliances.no_match") %>";
  $parentFieldset.append(noMatches);
}
